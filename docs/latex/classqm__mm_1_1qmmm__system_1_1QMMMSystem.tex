\hypertarget{classqm__mm_1_1qmmm__system_1_1QMMMSystem}{}\doxysection{qm\+\_\+mm.\+qmmm\+\_\+system.\+Q\+M\+M\+M\+System Class Reference}
\label{classqm__mm_1_1qmmm__system_1_1QMMMSystem}\index{qm\_mm.qmmm\_system.QMMMSystem@{qm\_mm.qmmm\_system.QMMMSystem}}
Inheritance diagram for qm\+\_\+mm.\+qmmm\+\_\+system.\+Q\+M\+M\+M\+System\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classqm__mm_1_1qmmm__system_1_1QMMMSystem}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classqm__mm_1_1qmmm__system_1_1QMMMSystem_a1fd938c8079d26e441cc5b8233f1f8ba}\label{classqm__mm_1_1qmmm__system_1_1QMMMSystem_a1fd938c8079d26e441cc5b8233f1f8ba}} 
def {\bfseries \+\_\+\+\_\+init\+\_\+\+\_\+} (self, qm\+\_\+subsystem, mm\+\_\+subsystem, group\+\_\+part\+\_\+dict, embedding\+\_\+cutoff=0, embedding\+\_\+method=\char`\"{}none\char`\"{}, qmmm\+\_\+pme=False, qmmm\+\_\+pme\+\_\+gridnumber=100, qmmm\+\_\+pme\+\_\+alpha=5.\+0)
\item 
def \mbox{\hyperlink{classqm__mm_1_1qmmm__system_1_1QMMMSystem_ab024212276cd08ca7f5ff33dd0746186}{single\+\_\+point\+\_\+energy}} (self, tare=False)
\item 
def \mbox{\hyperlink{classqm__mm_1_1qmmm__system_1_1QMMMSystem_a14572863dbb3433e44b6faae3ce90ebc}{generate\+\_\+embedding\+\_\+list}} (self, threshold=None)
\item 
\mbox{\Hypertarget{classqm__mm_1_1qmmm__system_1_1QMMMSystem_ab0ac3c9a1583f33e3c8301d57b7cff20}\label{classqm__mm_1_1qmmm__system_1_1QMMMSystem_ab0ac3c9a1583f33e3c8301d57b7cff20}} 
def {\bfseries residue\+\_\+part\+\_\+list} (self, residue\+\_\+part\+\_\+list)
\item 
\mbox{\Hypertarget{classqm__mm_1_1qmmm__system_1_1QMMMSystem_a7fc47223d70dfe9bdb5fcf0cfa92a69b}\label{classqm__mm_1_1qmmm__system_1_1QMMMSystem_a7fc47223d70dfe9bdb5fcf0cfa92a69b}} 
def {\bfseries group\+\_\+part\+\_\+dict} (self, group\+\_\+part\+\_\+dict)
\item 
\mbox{\Hypertarget{classqm__mm_1_1qmmm__system_1_1QMMMSystem_af869e7891a2fa755a83074b24b92e88e}\label{classqm__mm_1_1qmmm__system_1_1QMMMSystem_af869e7891a2fa755a83074b24b92e88e}} 
def {\bfseries element\+\_\+symbols} (self, element\+\_\+symbols)
\item 
\mbox{\Hypertarget{classqm__mm_1_1qmmm__system_1_1QMMMSystem_adcf9348250e78ff16fff608282a262c4}\label{classqm__mm_1_1qmmm__system_1_1QMMMSystem_adcf9348250e78ff16fff608282a262c4}} 
def {\bfseries charges} (self, charges)
\item 
\mbox{\Hypertarget{classqm__mm_1_1qmmm__system_1_1QMMMSystem_a29ca48a71d34ed40d86702e892e89c10}\label{classqm__mm_1_1qmmm__system_1_1QMMMSystem_a29ca48a71d34ed40d86702e892e89c10}} 
def {\bfseries positions} (self, positions)
\item 
\mbox{\Hypertarget{classqm__mm_1_1qmmm__system_1_1QMMMSystem_a7bb236facb8b3c7694239bd5e3256394}\label{classqm__mm_1_1qmmm__system_1_1QMMMSystem_a7bb236facb8b3c7694239bd5e3256394}} 
def {\bfseries box} (self, box)
\end{DoxyCompactItemize}
\doxysubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classqm__mm_1_1qmmm__system_1_1QMMMSystem_a05dffa92c8959ff349601a0c8f85cd12}\label{classqm__mm_1_1qmmm__system_1_1QMMMSystem_a05dffa92c8959ff349601a0c8f85cd12}} 
{\bfseries qm\+\_\+subsystem}
\item 
\mbox{\Hypertarget{classqm__mm_1_1qmmm__system_1_1QMMMSystem_a99fc773479bc2658a80de9ffb7a0918e}\label{classqm__mm_1_1qmmm__system_1_1QMMMSystem_a99fc773479bc2658a80de9ffb7a0918e}} 
{\bfseries mm\+\_\+subsystem}
\item 
\mbox{\Hypertarget{classqm__mm_1_1qmmm__system_1_1QMMMSystem_ad5a36f44c88dd8d7c1e8424dd74efd90}\label{classqm__mm_1_1qmmm__system_1_1QMMMSystem_ad5a36f44c88dd8d7c1e8424dd74efd90}} 
{\bfseries subsystems}
\item 
\mbox{\Hypertarget{classqm__mm_1_1qmmm__system_1_1QMMMSystem_a17892f81b61f559f8a1cdabd9bb62a54}\label{classqm__mm_1_1qmmm__system_1_1QMMMSystem_a17892f81b61f559f8a1cdabd9bb62a54}} 
{\bfseries residue\+\_\+part\+\_\+list}
\item 
\mbox{\Hypertarget{classqm__mm_1_1qmmm__system_1_1QMMMSystem_a8944b016a5fb91be8f3d0d4271023c26}\label{classqm__mm_1_1qmmm__system_1_1QMMMSystem_a8944b016a5fb91be8f3d0d4271023c26}} 
{\bfseries group\+\_\+part\+\_\+dict}
\item 
\mbox{\Hypertarget{classqm__mm_1_1qmmm__system_1_1QMMMSystem_ae7d8d3120c1da19231f8a0543634c12f}\label{classqm__mm_1_1qmmm__system_1_1QMMMSystem_ae7d8d3120c1da19231f8a0543634c12f}} 
{\bfseries element\+\_\+symbols}
\item 
\mbox{\Hypertarget{classqm__mm_1_1qmmm__system_1_1QMMMSystem_ad3a60fcc94a1fdee06c5f41d8f1a94fa}\label{classqm__mm_1_1qmmm__system_1_1QMMMSystem_ad3a60fcc94a1fdee06c5f41d8f1a94fa}} 
{\bfseries charges}
\item 
\mbox{\Hypertarget{classqm__mm_1_1qmmm__system_1_1QMMMSystem_ad60401357317c6e1aa842a853d337b9c}\label{classqm__mm_1_1qmmm__system_1_1QMMMSystem_ad60401357317c6e1aa842a853d337b9c}} 
{\bfseries positions}
\item 
\mbox{\Hypertarget{classqm__mm_1_1qmmm__system_1_1QMMMSystem_a495f6d2892c9dfcbf14e696211a41637}\label{classqm__mm_1_1qmmm__system_1_1QMMMSystem_a495f6d2892c9dfcbf14e696211a41637}} 
{\bfseries box}
\item 
\mbox{\Hypertarget{classqm__mm_1_1qmmm__system_1_1QMMMSystem_a40e5e1d169ad5728a44ad2cee450f621}\label{classqm__mm_1_1qmmm__system_1_1QMMMSystem_a40e5e1d169ad5728a44ad2cee450f621}} 
{\bfseries embedding\+\_\+cutoff}
\item 
\mbox{\Hypertarget{classqm__mm_1_1qmmm__system_1_1QMMMSystem_abc22d8fd5e3c8cd2cb5f0a31243eefde}\label{classqm__mm_1_1qmmm__system_1_1QMMMSystem_abc22d8fd5e3c8cd2cb5f0a31243eefde}} 
{\bfseries embedding\+\_\+method}
\item 
\mbox{\Hypertarget{classqm__mm_1_1qmmm__system_1_1QMMMSystem_ae3da09e6dabfe0e7fcc651eed6ba3a14}\label{classqm__mm_1_1qmmm__system_1_1QMMMSystem_ae3da09e6dabfe0e7fcc651eed6ba3a14}} 
{\bfseries qmmm\+\_\+pme}
\item 
\mbox{\Hypertarget{classqm__mm_1_1qmmm__system_1_1QMMMSystem_ab28ce52c0e7c0f190199c99eb1ce3d40}\label{classqm__mm_1_1qmmm__system_1_1QMMMSystem_ab28ce52c0e7c0f190199c99eb1ce3d40}} 
{\bfseries qmmm\+\_\+pme\+\_\+gridnumber}
\item 
\mbox{\Hypertarget{classqm__mm_1_1qmmm__system_1_1QMMMSystem_aed2e55c70f5e7060f36abd2392891bcf}\label{classqm__mm_1_1qmmm__system_1_1QMMMSystem_aed2e55c70f5e7060f36abd2392891bcf}} 
{\bfseries qmmm\+\_\+pme\+\_\+alpha}
\item 
\mbox{\Hypertarget{classqm__mm_1_1qmmm__system_1_1QMMMSystem_a61c8a27437c46660a39b6fc10cc632ad}\label{classqm__mm_1_1qmmm__system_1_1QMMMSystem_a61c8a27437c46660a39b6fc10cc632ad}} 
{\bfseries rs\+\_\+subsystem}
\item 
\mbox{\Hypertarget{classqm__mm_1_1qmmm__system_1_1QMMMSystem_a0c07d86ebea134eb6588f9a83fd8913d}\label{classqm__mm_1_1qmmm__system_1_1QMMMSystem_a0c07d86ebea134eb6588f9a83fd8913d}} 
{\bfseries pbc\+\_\+subsystem}
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}QM/MM system object to handle interactions between QM and MM regions.

Parameters
----------
qm_subsystem: QMSubsystem object
    Contains all relevant information for calculations involving the
    QM subsystem.
mm_subsystem: MMSubsystem object
    Contains all relevant information for calculations involving the
    MM subsystem.
group_part_dict: dict of list of list of int
    The indices of particles in the system grouped by a given key.
    Example keys include "qm_atom", "qm_drude", and "analytic".
embedding_cutoff: float or list, Optional, default=0
    The short-range electrostatic embedding cutoff.  Must be a float,
    unless the embedding_method is specified to be "hybrid", in
    which case the cutoff must be a two-element list of floats.  The
    lesser of the two floats is taken to be the analytic embedding
    cutoff.  The greater of the two floats is taken to be a 
    real-space embedding cutoff.  Real-space embedding is performed
    on the particles between the analytic embedding and real-space
    embedding cutoffs, and analytic embedding is performed on the
    particles within the analytic embedding cutoff.
embedding_method: str, Optional, default="none"
    The method to use for short-range electrostatic embedding.
    Options include "analytic", "realspace", and "hybrid".  Analytic
    embedding incorporates short-range partial point charges as
    one-electron operators within the QM Hamiltonian.  Real-space
    embedding incorporates short-range partial point charges as 
    non-truncated Coulomb interactions between smeared point charges
    within the PME potential grid, which is interpolated into the
    exchange correlation functional quadrature for the QM/MM/PME
    method.  Hybrid embedding employs both analytic and real-space
    embedding at different cutoffs.
qmmm_pme: bool, Optional, default=False
    Determine whether or not to include extended electrostatics
    using the QM/MM/PME method.
qmmm_pme_gridnumber: int, Optional, default=100
    The number of grid points to use along each of the box vectors
    of the principal cell during the PME procedure.
qmmm_pme_alpha: float, Optional, default=5.0
    The Gaussian width of the smeared point charges in the Ewald
    summation scheme, in inverse nanometers.  See OpenMM's
    documentation for further discussion.
\end{DoxyVerb}
 

\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classqm__mm_1_1qmmm__system_1_1QMMMSystem_a14572863dbb3433e44b6faae3ce90ebc}\label{classqm__mm_1_1qmmm__system_1_1QMMMSystem_a14572863dbb3433e44b6faae3ce90ebc}} 
\index{qm\_mm.qmmm\_system.QMMMSystem@{qm\_mm.qmmm\_system.QMMMSystem}!generate\_embedding\_list@{generate\_embedding\_list}}
\index{generate\_embedding\_list@{generate\_embedding\_list}!qm\_mm.qmmm\_system.QMMMSystem@{qm\_mm.qmmm\_system.QMMMSystem}}
\doxysubsubsection{\texorpdfstring{generate\_embedding\_list()}{generate\_embedding\_list()}}
{\footnotesize\ttfamily def qm\+\_\+mm.\+qmmm\+\_\+system.\+Q\+M\+M\+M\+System.\+generate\+\_\+embedding\+\_\+list (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{threshold = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Create the embedding list for the current state of the system.

The distances from the QM atoms are computed using the centroid
of the non-QM molecule from the centroid of the QM atoms.  The
legacy method involves computing distances using the first atom
position from the non-QM molecule instead.

Parameters
----------
threshold: float, Optional, default=None
    The threshold distance within which to include particles in
    the embedding list.  If no threshold is specified, the
    embedding_cutoff attribute is taken to be the threshold.

Returns
-------
embedding_list: list of tuple of int
    The list of embedded particles, arranged by residue in
    tuples.
\end{DoxyVerb}
 \mbox{\Hypertarget{classqm__mm_1_1qmmm__system_1_1QMMMSystem_ab024212276cd08ca7f5ff33dd0746186}\label{classqm__mm_1_1qmmm__system_1_1QMMMSystem_ab024212276cd08ca7f5ff33dd0746186}} 
\index{qm\_mm.qmmm\_system.QMMMSystem@{qm\_mm.qmmm\_system.QMMMSystem}!single\_point\_energy@{single\_point\_energy}}
\index{single\_point\_energy@{single\_point\_energy}!qm\_mm.qmmm\_system.QMMMSystem@{qm\_mm.qmmm\_system.QMMMSystem}}
\doxysubsubsection{\texorpdfstring{single\_point\_energy()}{single\_point\_energy()}}
{\footnotesize\ttfamily def qm\+\_\+mm.\+qmmm\+\_\+system.\+Q\+M\+M\+M\+System.\+single\+\_\+point\+\_\+energy (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{tare = {\ttfamily False} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Perform a single-point energy calculation for the system.

The energy calculated is effectively the partially
self-consistent electrostatic interaction energy of the QM
subsystem and MM subsystem (and extended subsystem, if the
QM/MM/PME method is being used.

Parameters
----------
tare: bool, Optional, default=False
    Determine whether or not to tare the gas-phase energy from
    the calculation.

Returns
-------
energy: float
    The electrostatic interaction energy of the QM subsystem
    with the MM subsystem (and the extended subsytem, if the
    QM/MM/PME method is being used).
\end{DoxyVerb}
 

The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
/storage/coda1/p-\/jmcdaniel43/0/jpederson6/rich\+\_\+project\+\_\+chem-\/mcdaniel/temp/\+Q\+M\+\_\+\+M\+M/qm\+\_\+mm/qmmm\+\_\+system.\+py\end{DoxyCompactItemize}
