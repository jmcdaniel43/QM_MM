\hypertarget{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem}{}\doxysection{qm\+\_\+mm.\+pbc\+\_\+subsystem.\+P\+B\+C\+Subsystem Class Reference}
\label{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem}\index{qm\_mm.pbc\_subsystem.PBCSubsystem@{qm\_mm.pbc\_subsystem.PBCSubsystem}}
Inheritance diagram for qm\+\_\+mm.\+pbc\+\_\+subsystem.\+P\+B\+C\+Subsystem\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_a6082c92da2ef1238085a46db4952a0d6}\label{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_a6082c92da2ef1238085a46db4952a0d6}} 
def {\bfseries \+\_\+\+\_\+init\+\_\+\+\_\+} (self, qmmm\+\_\+pme\+\_\+gridnumber, qmmm\+\_\+pme\+\_\+alpha, group\+\_\+part\+\_\+dict, charges, positions, box)
\item 
def \mbox{\hyperlink{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_af1ccdba5ddea102c9fcbdaa24a7f3dbc}{build\+\_\+pme\+\_\+exclusions}} (self, ref\+\_\+quadrature)
\item 
def \mbox{\hyperlink{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_a80af1fc5f32551ac8d94f5cbb9c81439}{apply\+\_\+pme\+\_\+exclusions}} (self, external\+\_\+grid)
\item 
def \mbox{\hyperlink{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_a718b9bb27f38fd671cc9801f69d47274}{box}} (self)
\item 
\mbox{\Hypertarget{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_a0e67847784909f35f08e1021af6cdd56}\label{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_a0e67847784909f35f08e1021af6cdd56}} 
def {\bfseries box} (self, box)
\end{DoxyCompactItemize}
\doxysubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \mbox{\hyperlink{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_a3a9c551cb66de84ead96af666eb21b22}{project\+\_\+to\+\_\+pme\+\_\+grid}} (points, inverse\+\_\+box, pme\+\_\+gridnumber)
\end{DoxyCompactItemize}
\doxysubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_a5e321ae3c27a40bbfb5ca0d3ce23fe18}\label{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_a5e321ae3c27a40bbfb5ca0d3ce23fe18}} 
{\bfseries qmmm\+\_\+pme\+\_\+gridnumber}
\item 
\mbox{\Hypertarget{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_af62b2339bf99328c612373515f0aaacc}\label{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_af62b2339bf99328c612373515f0aaacc}} 
{\bfseries qmmm\+\_\+pme\+\_\+alpha}
\item 
\mbox{\Hypertarget{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_a66e44ac5c2251fe5648e41e0b4b863be}\label{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_a66e44ac5c2251fe5648e41e0b4b863be}} 
{\bfseries group\+\_\+part\+\_\+dict}
\item 
\mbox{\Hypertarget{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_acf606f38533d32678d4b492f070549d2}\label{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_acf606f38533d32678d4b492f070549d2}} 
{\bfseries charges}
\item 
\mbox{\Hypertarget{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_a5149c4fbfb12d25290a7c30f628c57de}\label{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_a5149c4fbfb12d25290a7c30f628c57de}} 
{\bfseries positions}
\item 
\mbox{\Hypertarget{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_ae7aaba3c9a06a72a56f7517ef74171e4}\label{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_ae7aaba3c9a06a72a56f7517ef74171e4}} 
{\bfseries box}
\item 
\mbox{\Hypertarget{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_a78bc5bd2251197a484db1c86be2cac90}\label{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_a78bc5bd2251197a484db1c86be2cac90}} 
{\bfseries pme\+\_\+xyz}
\item 
\mbox{\Hypertarget{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_a7d2347a957ec53c8035a23827d9523c2}\label{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_a7d2347a957ec53c8035a23827d9523c2}} 
{\bfseries pme\+\_\+exclusion\+\_\+list}
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}The extended environment subsystem for the QM/MM/PME method.

Parameters
----------
qmmm_pme_gridnumber: int
    The number of grid points to use along each of the box vectors
    of the principal cell during the PME procedure.
qmmm_pme_alpha: float
    The Gaussian width of the smeared point charges in the Ewald
    summation scheme, in inverse nanometers.  See OpenMM's
    documentation for further discussion.
group_part_dict: dict of list of list of int
    The indices of particles in the system grouped by a given key.
    Example keys include "qm_atom", "qm_drude", and "analytic".
charges: NumPy Array object
    The charges of all particles in the system, in proton charge
    units.
positions: NumPy Array object
    The positions of all particles in the system, in Angstroms.
box: NumPy Array object
    The box vectors defining the periodic system, in Angstroms.
\end{DoxyVerb}
 

\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_a80af1fc5f32551ac8d94f5cbb9c81439}\label{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_a80af1fc5f32551ac8d94f5cbb9c81439}} 
\index{qm\_mm.pbc\_subsystem.PBCSubsystem@{qm\_mm.pbc\_subsystem.PBCSubsystem}!apply\_pme\_exclusions@{apply\_pme\_exclusions}}
\index{apply\_pme\_exclusions@{apply\_pme\_exclusions}!qm\_mm.pbc\_subsystem.PBCSubsystem@{qm\_mm.pbc\_subsystem.PBCSubsystem}}
\doxysubsubsection{\texorpdfstring{apply\_pme\_exclusions()}{apply\_pme\_exclusions()}}
{\footnotesize\ttfamily def qm\+\_\+mm.\+pbc\+\_\+subsystem.\+P\+B\+C\+Subsystem.\+apply\+\_\+pme\+\_\+exclusions (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{external\+\_\+grid }\end{DoxyParamCaption})}

\begin{DoxyVerb}Apply exlcusions to relevant external potential grid points.

Parameters
----------
external_grid: list of float
    The external potential grid calculated by OpenMM.

Returns
-------
external_grid: NumPy Array object
    The external potential grid with exclusions applied for the
    potential associated with the QM atoms and analytic
    embedding particles in the principal box, as well as
    real-space embedding corrections if selected.
\end{DoxyVerb}
 \mbox{\Hypertarget{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_a718b9bb27f38fd671cc9801f69d47274}\label{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_a718b9bb27f38fd671cc9801f69d47274}} 
\index{qm\_mm.pbc\_subsystem.PBCSubsystem@{qm\_mm.pbc\_subsystem.PBCSubsystem}!box@{box}}
\index{box@{box}!qm\_mm.pbc\_subsystem.PBCSubsystem@{qm\_mm.pbc\_subsystem.PBCSubsystem}}
\doxysubsubsection{\texorpdfstring{box()}{box()}}
{\footnotesize\ttfamily def qm\+\_\+mm.\+pbc\+\_\+subsystem.\+P\+B\+C\+Subsystem.\+box (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}The box vectors defining the periodic system.
\end{DoxyVerb}
 

Reimplemented from \mbox{\hyperlink{classqm__mm_1_1system_1_1System_a9c3bd1abdd6ba3655f07bbfb67dcb515}{qm\+\_\+mm.\+system.\+System}}.

\mbox{\Hypertarget{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_af1ccdba5ddea102c9fcbdaa24a7f3dbc}\label{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_af1ccdba5ddea102c9fcbdaa24a7f3dbc}} 
\index{qm\_mm.pbc\_subsystem.PBCSubsystem@{qm\_mm.pbc\_subsystem.PBCSubsystem}!build\_pme\_exclusions@{build\_pme\_exclusions}}
\index{build\_pme\_exclusions@{build\_pme\_exclusions}!qm\_mm.pbc\_subsystem.PBCSubsystem@{qm\_mm.pbc\_subsystem.PBCSubsystem}}
\doxysubsubsection{\texorpdfstring{build\_pme\_exclusions()}{build\_pme\_exclusions()}}
{\footnotesize\ttfamily def qm\+\_\+mm.\+pbc\+\_\+subsystem.\+P\+B\+C\+Subsystem.\+build\+\_\+pme\+\_\+exclusions (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{ref\+\_\+quadrature }\end{DoxyParamCaption})}

\begin{DoxyVerb}Collect the PME points to which exclusions will be applied.

The points include the region containing the quadrature grid.

Parameters
----------
ref_quadrature: NumPy Array object
    A reference quadrature constructed from the geometry of the
    QM subsystem.
\end{DoxyVerb}
 \mbox{\Hypertarget{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_a3a9c551cb66de84ead96af666eb21b22}\label{classqm__mm_1_1pbc__subsystem_1_1PBCSubsystem_a3a9c551cb66de84ead96af666eb21b22}} 
\index{qm\_mm.pbc\_subsystem.PBCSubsystem@{qm\_mm.pbc\_subsystem.PBCSubsystem}!project\_to\_pme\_grid@{project\_to\_pme\_grid}}
\index{project\_to\_pme\_grid@{project\_to\_pme\_grid}!qm\_mm.pbc\_subsystem.PBCSubsystem@{qm\_mm.pbc\_subsystem.PBCSubsystem}}
\doxysubsubsection{\texorpdfstring{project\_to\_pme\_grid()}{project\_to\_pme\_grid()}}
{\footnotesize\ttfamily def qm\+\_\+mm.\+pbc\+\_\+subsystem.\+P\+B\+C\+Subsystem.\+project\+\_\+to\+\_\+pme\+\_\+grid (\begin{DoxyParamCaption}\item[{}]{points,  }\item[{}]{inverse\+\_\+box,  }\item[{}]{pme\+\_\+gridnumber }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\begin{DoxyVerb}Project points onto a PME grid in reciprocal space.

This algorithm is identical to that used in method
'pme_update_grid_index_and_fraction' in OpenMM source code,
ReferencePME.cpp.

Parameters
----------
points: NumPy Array object
    The real-space points, in Bohr, to project onto the
    reciprocal-space PME grid.
inverse_box: NumPy Array object
    The inverse of the box vector defining the principal cell of
    the system, in inverse Bohr.
pme_gridnumber: int
    The number of grid points along each box vector within the
    system.

Return
------
scaled_grid_points: NumPy Array object
    The projected points in reciprocal-space, in inverse Bohr.
\end{DoxyVerb}
 

The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
/storage/coda1/p-\/jmcdaniel43/0/jpederson6/rich\+\_\+project\+\_\+chem-\/mcdaniel/temp/\+Q\+M\+\_\+\+M\+M/qm\+\_\+mm/pbc\+\_\+subsystem.\+py\end{DoxyCompactItemize}
