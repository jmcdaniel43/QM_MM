\hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface}{\section{qm\-\_\-mm.\-psi4\-\_\-interface.\-psi4\-\_\-interface Class Reference}
\label{classqm__mm_1_1psi4__interface_1_1psi4__interface}\index{qm\-\_\-mm.\-psi4\-\_\-interface.\-psi4\-\_\-interface@{qm\-\_\-mm.\-psi4\-\_\-interface.\-psi4\-\_\-interface}}
}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface_a5a8ed32b1b42bb5fb6aa7289b5759cb2}{def {\bfseries \-\_\-\-\_\-init\-\_\-\-\_\-}}\label{classqm__mm_1_1psi4__interface_1_1psi4__interface_a5a8ed32b1b42bb5fb6aa7289b5759cb2}

\item 
def \hyperlink{classqm__mm_1_1psi4__interface_1_1psi4__interface_a660fd7e726174d2bba77c9e162e620ea}{generate\-\_\-geometry}
\item 
def \hyperlink{classqm__mm_1_1psi4__interface_1_1psi4__interface_aee7153d3d7f9c5d3fc412331f87d3554}{generate\-\_\-pme\-\_\-xyz}
\item 
def \hyperlink{classqm__mm_1_1psi4__interface_1_1psi4__interface_a75c8238500fa9969d6b6f0495e2f879f}{generate\-\_\-pme\-\_\-exclusions}
\item 
def \hyperlink{classqm__mm_1_1psi4__interface_1_1psi4__interface_a1fcae35bb87bc0d9f12b013c0f6dc107}{apply\-\_\-pme\-\_\-exclusions}
\item 
def \hyperlink{classqm__mm_1_1psi4__interface_1_1psi4__interface_a5deae90102d64f40346e1d462248b08b}{calc\-\_\-energy}
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface_a1ebbbd133d47d4ea6d2eef20d5d376c8}{{\bfseries basis\-\_\-set}}\label{classqm__mm_1_1psi4__interface_1_1psi4__interface_a1ebbbd133d47d4ea6d2eef20d5d376c8}

\item 
\hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface_a9f81d1b6a43a9dcc3a55c44afac4d6ad}{{\bfseries functional}}\label{classqm__mm_1_1psi4__interface_1_1psi4__interface_a9f81d1b6a43a9dcc3a55c44afac4d6ad}

\item 
\hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface_a898b23fb5e63b19edb9423ac51bfdbc2}{{\bfseries quadrature\-\_\-spherical}}\label{classqm__mm_1_1psi4__interface_1_1psi4__interface_a898b23fb5e63b19edb9423ac51bfdbc2}

\item 
\hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface_af8cfc3e9be3086ad30ee204f8a1465a0}{{\bfseries quadrature\-\_\-radial}}\label{classqm__mm_1_1psi4__interface_1_1psi4__interface_af8cfc3e9be3086ad30ee204f8a1465a0}

\item 
\hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface_ac7ea41d142a66eca166d9c151df97d22}{{\bfseries qm\-\_\-charge}}\label{classqm__mm_1_1psi4__interface_1_1psi4__interface_ac7ea41d142a66eca166d9c151df97d22}

\item 
\hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface_a45a92460d034a3f01ed1f609b2c84775}{{\bfseries qm\-\_\-spin}}\label{classqm__mm_1_1psi4__interface_1_1psi4__interface_a45a92460d034a3f01ed1f609b2c84775}

\item 
\hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface_aec1124ab4316fb2856adc8688b0da0e6}{{\bfseries qmmm\-\_\-pme}}\label{classqm__mm_1_1psi4__interface_1_1psi4__interface_aec1124ab4316fb2856adc8688b0da0e6}

\item 
\hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface_a006bd126a09805b30165dc70876352d1}{{\bfseries pme\-\_\-grid\-\_\-number}}\label{classqm__mm_1_1psi4__interface_1_1psi4__interface_a006bd126a09805b30165dc70876352d1}

\item 
\hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface_a4469929ab2817ff5959c418bb34e0247}{{\bfseries pme\-\_\-gaussian\-\_\-width}}\label{classqm__mm_1_1psi4__interface_1_1psi4__interface_a4469929ab2817ff5959c418bb34e0247}

\item 
\hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface_a70d72f1fe08da4c30dd41f1a2c34ac1c}{{\bfseries pme\-\_\-realspace\-\_\-method}}\label{classqm__mm_1_1psi4__interface_1_1psi4__interface_a70d72f1fe08da4c30dd41f1a2c34ac1c}

\item 
\hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface_a655c4659d7a6c8f37b9bf58e2119ea83}{{\bfseries box}}\label{classqm__mm_1_1psi4__interface_1_1psi4__interface_a655c4659d7a6c8f37b9bf58e2119ea83}

\item 
\hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface_a94f0be17148594e98a1ad91acf02d1aa}{{\bfseries bohr\-\_\-box}}\label{classqm__mm_1_1psi4__interface_1_1psi4__interface_a94f0be17148594e98a1ad91acf02d1aa}

\item 
\hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface_a1a9e8410ee743e1a4b0a2c6e4909e370}{{\bfseries read\-\_\-guess}}\label{classqm__mm_1_1psi4__interface_1_1psi4__interface_a1a9e8410ee743e1a4b0a2c6e4909e370}

\item 
\hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface_a9736925c245863684dad72f30e5f1599}{{\bfseries wfn}}\label{classqm__mm_1_1psi4__interface_1_1psi4__interface_a9736925c245863684dad72f30e5f1599}

\item 
\hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface_ae64fff76eb3d0461d53c2b2e01ce434a}{{\bfseries scf\-\_\-type}}\label{classqm__mm_1_1psi4__interface_1_1psi4__interface_ae64fff76eb3d0461d53c2b2e01ce434a}

\item 
\hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface_a3aa6222a9fe3df3d8e7edf74690f5900}{{\bfseries embedding\-\_\-list}}\label{classqm__mm_1_1psi4__interface_1_1psi4__interface_a3aa6222a9fe3df3d8e7edf74690f5900}

\item 
\hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface_abd09f91fd00e10a7ef4d4bf5f7c8778b}{{\bfseries qm\-\_\-drudes\-\_\-list}}\label{classqm__mm_1_1psi4__interface_1_1psi4__interface_abd09f91fd00e10a7ef4d4bf5f7c8778b}

\item 
\hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface_ab0afc019b0c4c04a99c1e4b19bbd499d}{{\bfseries positions}}\label{classqm__mm_1_1psi4__interface_1_1psi4__interface_ab0afc019b0c4c04a99c1e4b19bbd499d}

\item 
\hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface_a08717d4f122859d2caad47e85eae279b}{{\bfseries geometry}}\label{classqm__mm_1_1psi4__interface_1_1psi4__interface_a08717d4f122859d2caad47e85eae279b}

\item 
\hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface_ae6a5b0de9f29e6fd6502ac715481da41}{{\bfseries pme\-\_\-xyz}}\label{classqm__mm_1_1psi4__interface_1_1psi4__interface_ae6a5b0de9f29e6fd6502ac715481da41}

\item 
\hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface_a7d2e42f70b9f40d665796e6d14ff4c15}{{\bfseries quadrature\-\_\-grid}}\label{classqm__mm_1_1psi4__interface_1_1psi4__interface_a7d2e42f70b9f40d665796e6d14ff4c15}

\item 
\hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface_a787a1f805a1efad99e81daf49d681b89}{{\bfseries pme\-\_\-exclusion\-\_\-list}}\label{classqm__mm_1_1psi4__interface_1_1psi4__interface_a787a1f805a1efad99e81daf49d681b89}

\end{DoxyCompactItemize}
\subsection*{Static Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface_a60f69cfc08c392e6b313ccae38d455a3}{float {\bfseries nm\-\_\-to\-\_\-bohr} = 18.\-89726}\label{classqm__mm_1_1psi4__interface_1_1psi4__interface_a60f69cfc08c392e6b313ccae38d455a3}

\item 
\hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface_a11f899a5c8eaa4b1a747f848006cbbda}{float {\bfseries angstrom\-\_\-to\-\_\-bohr} = 1.\-889726}\label{classqm__mm_1_1psi4__interface_1_1psi4__interface_a11f899a5c8eaa4b1a747f848006cbbda}

\item 
\hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface_a9f02534569678828b17a217302db0fa3}{float {\bfseries hartree\-\_\-to\-\_\-kjmol} = 2625.\-4996}\label{classqm__mm_1_1psi4__interface_1_1psi4__interface_a9f02534569678828b17a217302db0fa3}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Psi4 interface for the QM subsystem.

Parameters
----------
basis_set: str
    Name of desired Psi4 basis set.
functional: str
    Name of desired Psi4 density functional.
quadrature_spherical: int
    Number of spherical (angular and azimuthal) points for the 
    exchange-correlation functional quadrature.
quadrature_radial: int
    Number of radial points for the exchange-correlation functional
    quadrature.
qm_charge: int
    Charge of the QM system in proton charge
qm_spin: int
    Spin of the QM system.
n_threads: int, Optional, default=1
    Number of threads across which to parallelize the QM calculation.
read_guess: bool, Optional, default=True
    Determine whether to base calculations on previous wavefunction
    objects (default) or on the Psi4 default SAD.
\end{DoxyVerb}
 

\subsection{Member Function Documentation}
\hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface_a1fcae35bb87bc0d9f12b013c0f6dc107}{\index{qm\-\_\-mm\-::psi4\-\_\-interface\-::psi4\-\_\-interface@{qm\-\_\-mm\-::psi4\-\_\-interface\-::psi4\-\_\-interface}!apply\-\_\-pme\-\_\-exclusions@{apply\-\_\-pme\-\_\-exclusions}}
\index{apply\-\_\-pme\-\_\-exclusions@{apply\-\_\-pme\-\_\-exclusions}!qm_mm::psi4_interface::psi4_interface@{qm\-\_\-mm\-::psi4\-\_\-interface\-::psi4\-\_\-interface}}
\subsubsection[{apply\-\_\-pme\-\_\-exclusions}]{\setlength{\rightskip}{0pt plus 5cm}def qm\-\_\-mm.\-psi4\-\_\-interface.\-psi4\-\_\-interface.\-apply\-\_\-pme\-\_\-exclusions (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{v\-\_\-external}
\end{DoxyParamCaption}
)}}\label{classqm__mm_1_1psi4__interface_1_1psi4__interface_a1fcae35bb87bc0d9f12b013c0f6dc107}
\begin{DoxyVerb}Edit external potential grid to reflect exclusions.

Parameters
----------
v_external:
\end{DoxyVerb}
 \hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface_a5deae90102d64f40346e1d462248b08b}{\index{qm\-\_\-mm\-::psi4\-\_\-interface\-::psi4\-\_\-interface@{qm\-\_\-mm\-::psi4\-\_\-interface\-::psi4\-\_\-interface}!calc\-\_\-energy@{calc\-\_\-energy}}
\index{calc\-\_\-energy@{calc\-\_\-energy}!qm_mm::psi4_interface::psi4_interface@{qm\-\_\-mm\-::psi4\-\_\-interface\-::psi4\-\_\-interface}}
\subsubsection[{calc\-\_\-energy}]{\setlength{\rightskip}{0pt plus 5cm}def qm\-\_\-mm.\-psi4\-\_\-interface.\-psi4\-\_\-interface.\-calc\-\_\-energy (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{vext = {\ttfamily None}}
\end{DoxyParamCaption}
)}}\label{classqm__mm_1_1psi4__interface_1_1psi4__interface_a5deae90102d64f40346e1d462248b08b}
\begin{DoxyVerb}Perform the Psi4 energy calculation.

Parameters
----------
v_external: Numpy Array object, Optional, default=None
\end{DoxyVerb}
 \hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface_a660fd7e726174d2bba77c9e162e620ea}{\index{qm\-\_\-mm\-::psi4\-\_\-interface\-::psi4\-\_\-interface@{qm\-\_\-mm\-::psi4\-\_\-interface\-::psi4\-\_\-interface}!generate\-\_\-geometry@{generate\-\_\-geometry}}
\index{generate\-\_\-geometry@{generate\-\_\-geometry}!qm_mm::psi4_interface::psi4_interface@{qm\-\_\-mm\-::psi4\-\_\-interface\-::psi4\-\_\-interface}}
\subsubsection[{generate\-\_\-geometry}]{\setlength{\rightskip}{0pt plus 5cm}def qm\-\_\-mm.\-psi4\-\_\-interface.\-psi4\-\_\-interface.\-generate\-\_\-geometry (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{positions, }
\item[{}]{embedding\-\_\-list = {\ttfamily None}, }
\item[{}]{qm\-\_\-drudes\-\_\-list = {\ttfamily None}}
\end{DoxyParamCaption}
)}}\label{classqm__mm_1_1psi4__interface_1_1psi4__interface_a660fd7e726174d2bba77c9e162e620ea}
\begin{DoxyVerb}Create the geometry string to feed into the Psi4 calculation.

Parameters
----------
embedding_list: list of list of int
    Integer indices of atoms within the analytic embedding cutoff
    grouped by residue.
offsets: list of list of float
    Offset to add onto the position of each atom grouped
    by residue.
positions: Numpy array
    Array of atom positions from the OpenMM State object.
\end{DoxyVerb}
 \hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface_a75c8238500fa9969d6b6f0495e2f879f}{\index{qm\-\_\-mm\-::psi4\-\_\-interface\-::psi4\-\_\-interface@{qm\-\_\-mm\-::psi4\-\_\-interface\-::psi4\-\_\-interface}!generate\-\_\-pme\-\_\-exclusions@{generate\-\_\-pme\-\_\-exclusions}}
\index{generate\-\_\-pme\-\_\-exclusions@{generate\-\_\-pme\-\_\-exclusions}!qm_mm::psi4_interface::psi4_interface@{qm\-\_\-mm\-::psi4\-\_\-interface\-::psi4\-\_\-interface}}
\subsubsection[{generate\-\_\-pme\-\_\-exclusions}]{\setlength{\rightskip}{0pt plus 5cm}def qm\-\_\-mm.\-psi4\-\_\-interface.\-psi4\-\_\-interface.\-generate\-\_\-pme\-\_\-exclusions (
\begin{DoxyParamCaption}
\item[{}]{self}
\end{DoxyParamCaption}
)}}\label{classqm__mm_1_1psi4__interface_1_1psi4__interface_a75c8238500fa9969d6b6f0495e2f879f}
\begin{DoxyVerb}Collect the PME points to exclude from the external potential.

The excluded points include the entire QM region and analytic
embedding region within the principal cell.
\end{DoxyVerb}
 \hypertarget{classqm__mm_1_1psi4__interface_1_1psi4__interface_aee7153d3d7f9c5d3fc412331f87d3554}{\index{qm\-\_\-mm\-::psi4\-\_\-interface\-::psi4\-\_\-interface@{qm\-\_\-mm\-::psi4\-\_\-interface\-::psi4\-\_\-interface}!generate\-\_\-pme\-\_\-xyz@{generate\-\_\-pme\-\_\-xyz}}
\index{generate\-\_\-pme\-\_\-xyz@{generate\-\_\-pme\-\_\-xyz}!qm_mm::psi4_interface::psi4_interface@{qm\-\_\-mm\-::psi4\-\_\-interface\-::psi4\-\_\-interface}}
\subsubsection[{generate\-\_\-pme\-\_\-xyz}]{\setlength{\rightskip}{0pt plus 5cm}def qm\-\_\-mm.\-psi4\-\_\-interface.\-psi4\-\_\-interface.\-generate\-\_\-pme\-\_\-xyz (
\begin{DoxyParamCaption}
\item[{}]{self}
\end{DoxyParamCaption}
)}}\label{classqm__mm_1_1psi4__interface_1_1psi4__interface_aee7153d3d7f9c5d3fc412331f87d3554}
\begin{DoxyVerb}Create the PME coordinates in Bohr.
\end{DoxyVerb}
 

The documentation for this class was generated from the following file\-:\begin{DoxyCompactItemize}
\item 
/storage/coda1/p-\/jmcdaniel43/0/jpederson6/rich\-\_\-project\-\_\-chem-\/mcdaniel/temp/\-Q\-M\-\_\-\-M\-M/qm\-\_\-mm/psi4\-\_\-interface.\-py\end{DoxyCompactItemize}
